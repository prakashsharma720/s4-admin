"use strict";$(document).ready(function(){$(".progress-1").circleProgress({max:100,value:50,textFormat:function(){return"$450 USD"}}),$(".progress-2").circleProgress({max:100,value:60,textFormat:function(){return"$550 USD"}}),$(".progress-3").circleProgress({max:100,value:70,textFormat:function(){return"$850 USD"}}),$(".progress-4").circleProgress({max:100,value:80,textFormat:function(){return"$900 USD"}})}),$(document).ready(function(){$("#proposalList, #upcomingActTab, #oldActTab, #todayActTab, #completeActTab, #incompleteActTab").DataTable({pageLength:10,lengthMenu:[10,20,50,100,200,500]})}),$(document).ready(function(){$("#checkAllProposal").change(function(){this.checked?$(".checkbox").each(function(){this.checked=!0,$(this).parent().parent().parent().parent().addClass("selected")}):$(".checkbox").each(function(){this.checked=!1,$(this).parent().parent().parent().parent().removeClass("selected")})}),$(".checkbox").click(function(){var e;$(this).is(":checked")?(e=0,$(".checkbox").each(function(){this.checked||(e=1)}),0==e&&$("#checkAllProposal").prop("checked",!0)):$("#checkAllProposal").prop("checked",!1)}),$(".items-wrapper").on("click","input:checkbox",function(){$(this).closest(".single-items").toggleClass("selected",this.checked)}),$(".items-wrapper input:checkbox:checked").closest(".single-items").addClass("selected")}),$(document).ready(function(){new Quill('[data-editor-target="editor"]',{placeholder:"Compose an epic...",theme:"snow"})}),$(document).ready(function(){$('[data-alert-target="alertMessage"]').click(function(e){e.preventDefault();const t=Swal.mixin({customClass:{confirmButton:"btn btn-success m-1",cancelButton:"btn btn-danger m-1"},buttonsStyling:!1});t.fire({title:"Are you sure?",text:"You want to sent this Proposal!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, sent it!",cancelButtonText:"No, cancel!",reverseButtons:!0}).then(e=>{e.value?t.fire("Sent!","Proposal sent successfully.","success"):e.dismiss===Swal.DismissReason.cancel&&t.fire("Cancelled","Your imaginary file is safe :)","error")})})});


// Leads Add and View Activities
$(document).ready(function () {
    // Add Activity button
    $(document).on("click", ".btnAddActivityOne", function () {
        let leadId = $(this).data("lead-id");
        $("#viewActivitiesSection" + leadId).fadeOut(300, function () {
            $("#addActivitySection" + leadId).fadeIn(300);
        });
    });

    // View Activity button
    $(document).on("click", ".btnViewActivityOne", function () {
        let leadId = $(this).data("lead-id");
        $("#addActivitySection" + leadId).fadeOut(300, function () {
            $("#viewActivitiesSection" + leadId).fadeIn(300);
        });
    });
});


$(document).ready(function () {
    // Add Activity button
    $(document).on("click", ".btnAddActivity", function () {
        let leadId = $(this).data("lead-id");
        $("#viewActivitiesSectionTwo" + leadId).fadeOut(300, function () {
            $("#addActivitySectionTwo" + leadId).fadeIn(300);
        });
    });

    // View Activity button
    $(document).on("click", ".btnViewActivity", function () {
        let leadId = $(this).data("lead-id");
        $("#addActivitySectionTwo" + leadId).fadeOut(300, function () {
            $("#viewActivitiesSectionTwo" + leadId).fadeIn(300);
        });
    });
});

// Lead Status Change Dropdown AJAX
$(document).on("change", ".lead-status", function () {
    var leadId = $(this).data("id");
    var newStatus = $(this).val();

    $.ajax({
        url: BASE_URL + "index.php/Leads/update_status",
        type: "POST",
        // data: { id: leadId, status: newStatus },
        data: { lead_id: leadId, status: newStatus },
        dataType: "json",
        success: function (response) {
            if (response.status) {
                //  alert("âœ… " + response.message + "\nLead: " + response.lead_title);
                location.reload();
            } else {
                alert(response.message);
            }
        },
        error: function () {
            alert("Something went wrong!");
        }
    });
});

// Lead Priority Change Dropdown AJAX

$(document).on("change", ".lead-priority", function () {
    var leadId = $(this).data("id");
    var newPriority = $(this).val();

    $.ajax({
        url: BASE_URL + "index.php/Leads/update_priority",
        type: "POST",
        data: { lead_id: leadId, priority: newPriority },
        dataType: "json",
        success: function (response) {
            if (response.status) {
                location.reload();
            } else {
                alert(response.message);
            }
        },
        error: function () {
            alert("Something went wrong!");
        }
    });
});

// Lead Assign Change Dropdown AJAX

$(document).on("change", ".lead-employee", function () {
    var leadId = $(this).data("id");
    var employeeId = $(this).val();

    $.ajax({
        url:  BASE_URL + "index.php/Leads/update_employee",
        type: "POST",
        data: { id: leadId, lead_assign: employeeId },
        dataType: "json",
        success: function (response) {
             if (response.status) {
                location.reload();
            } else {
                alert(response.message);
            }
        },
        error: function () {
            alert("Something went wrong!");
        }
    });
});